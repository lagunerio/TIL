## Â§ Dockerfile: CMD, RUN and ENTRYPOINT

### 1. RUN

ë„ì»¤ ì´ë¯¸ì§€ì— ìƒˆë¡œìš° íŒ¨í‚¤ì§€ë¥´ ì„¤ì¹˜í•˜ê±°ë‚˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ì‹œí‚¤ ê²½ìš° ì‚¬ìš©. ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ë ˆì´ì–´ê°€ ìƒì„±ë˜ë¯€ë¡œ, RUN ëª…ë ¹ì–´ë¥´ í•˜ë‚˜ë¡œ í†µí•©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

**Before**
```Bash
FROM  nvidia/cuda:11.1-runtime-ubuntu20.04
RUN   apt-get update
RUN   apt-get install -y apt-utils python3 python3-pip git wget nginx
RUN   pip3 install --upgrade pip
RUN   pip3 install --upgrade Pillow
RUN	  pip3 install Flask flask_jsonpify google google-cloud google-cloud-vision
RUN	  pip3 install --upgrade google-cloud-storage
RUN	  pip3 install torch==1.9.0+cu111 torchvision==0.10.0+cu111 -f https://download.pytorch.org/whl/torch_stable.html
RUN	  pip3 install -r requirements.txt
```

**Better**
```Bash
FROM  nvidia/cuda:11.1-runtime-ubuntu20.04
RUN   apt-get update
      && apt-get install -y apt-utils python3 python3-pip git wget nginx
      && pip3 install --upgrade pip
      && pip3 install --upgrade Pillow
      && pip3 install Flask flask_jsonpify google google-cloud google-cloud-vision
      && pip3 install --upgrade google-cloud-storage
      && pip3 install torch==1.9.0+cu111 torchvision==0.10.0+cu111 -f https://download.pytorch.org/whl/torch_stable.html
      && pip3 install -r requirements.txt
```

### 2. CMD

docker run ì‹¤í–‰ ì‹œ, ê°€ì¥ ë§ˆì§€ë§‰ CMD ëª…ë ¹ì–´ë§Œ ì‹¤í–‰ëœë‹¤.
ì´ ë•Œ, Dockerfileì˜ ë§ˆì§€ë§‰ ì¤„ ë˜ëŠ” docker run ëª…ë ¹ì–´ ë’¤ì— ë¶™ì´ëŠ” ëª…ë ¹ì–´ë¥¼ ë§ˆì§€ë§‰ CMD ëª…ë ¹ì–´ë¡œ ì¸ì‹í•œë‹¤.

```Bash
docker run -it {image_name} echo "Hello World"
```

### 3. ENTRYPOINT

docker run ëª…ë ¹ì–´ë¡œ ì»¨í…Œì´ë„ˆ ìƒì„± í›„ ì‹¤í–‰í•˜ëŠ” ëª…ë ¹ì–´ë¡œ, ë‘ ê°€ì§€ í‘œí˜„ ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.

**1) exec form (preferred)
```Bash
ENTRYPOINT  ["command", "param1", "param2", ...]
```

**2) shell form
```Bash
ENTRYPOINT  command param1 param2 ...
```

<br>

## ì°¸ê³  ìë£Œ

1. [ğŸ³ Dockerfile ëª…ë ¹ì–´ RUN, CMD, ENTRYPOINT ì°¨ì´](https://williamjeong2.github.io/blog/10-docker-run-vs-cmd-vs-entryporint/)
